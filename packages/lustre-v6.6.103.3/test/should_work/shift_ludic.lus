-- file `shift_ludic.lus' generated by lc
-- lustreV6 compiler version 1.1

-- internal type(s) definition(s)  
  type T1_ARRAY = bool^10;
  type T2_STRUCT = { multiplieur: T1_ARRAY; rank: int; actual_rank: int };
  type T3_ARRAY = bool^20;
  type T4_STRUCT = { currentRank: int; rankToSelect: int; elementSelected: bool };
  type T5_STRUCT = { multiplieur: T1_ARRAY; rank: int };
  type T6_STRUCT = { acc_in_PLC: T5_STRUCT; actual_rank: int };
  type T7_STRUCT = { eltToSearch: bool; iselementof: bool };

-- types aliases and constantes declarations
type t_T_isElementOf_ = T7_STRUCT;
type t_Tacc_in = T5_STRUCT;
type t_Tacc_inShift = T6_STRUCT;
type t_iteratedStruct = T4_STRUCT;
type t_Tacc_inShift2 = T2_STRUCT;
const c_size = 10;

-- operators 
node n_selectOneStage(
 i_acc_in : T4_STRUCT;
 i_currentElt : bool;
 ) returns ( 
 o_acc_out : T4_STRUCT;
 );
let
   o_acc_out = T4_STRUCT{ currentRank = (i_acc_in.currentRank + 1); rankToSelect = i_acc_in.rankToSelect; elementSelected = (if (i_acc_in.currentRank = i_acc_in.rankToSelect) 
		      then  i_currentElt 
		      else  i_acc_in.elementSelected )};
tel

node n_selectElementOfRank_inArray_(
 i_rankToSelect : int;
 i_array : T1_ARRAY;
 ) returns ( 
 o_elementSelected : bool;
 );
var
 v_iterationResult : T4_STRUCT;
let
   v_iterationResult = red<<n_selectOneStage; c_size>>(T4_STRUCT{ currentRank = 0; rankToSelect = i_rankToSelect; elementSelected = i_array[0]}, i_array);
   o_elementSelected = v_iterationResult.elementSelected;
tel

node n_shiftFill(
 i_acc_in : T2_STRUCT;
 ) returns ( 
 o_acc_out : T2_STRUCT;
 o_elt_out : bool;
 );
let
   o_acc_out = T2_STRUCT{ multiplieur = i_acc_in.multiplieur; rank = i_acc_in.rank; actual_rank = (i_acc_in.actual_rank + 1)};
   o_elt_out = (if ((i_acc_in.actual_rank >= i_acc_in.rank) and (i_acc_in.actual_rank < (i_acc_in.rank + c_size))) 
		      then  n_selectElementOfRank_inArray_(i_acc_in.actual_rank, i_acc_in.multiplieur) 
		      else  false );
tel

node shift_ludic(
 i_acc_in : T5_STRUCT;
 ) returns ( 
 o_ligne : T3_ARRAY;
 );
var
 v_bidon : T2_STRUCT;
let
   (v_bidon, o_ligne) = fill<<n_shiftFill; (2 * c_size)>>(T2_STRUCT{ multiplieur = i_acc_in.multiplieur; rank = i_acc_in.rank; actual_rank = 0});
tel

