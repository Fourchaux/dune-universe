<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Monad (mechaml.Mechaml.Agent.Monad)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../index.html">mechaml</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Mechaml.Agent.Monad</span></h1></header><div class="spec type" id="type-m"><a href="#type-m" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a m</code><code><span class="keyword"> = </span><a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (<a href="../index.html#type-t">t</a><span class="keyword"> * </span><span class="type-var">'a</span>) Lwt.t</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-bind"><a href="#val-bind" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>bind : <span class="type-var">'a</span> <a href="index.html#type-m">m</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a>) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-return"><a href="#val-return" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>return : <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-return_from_lwt"><a href="#val-return_from_lwt" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>return_from_lwt : <span class="type-var">'a</span> Lwt.t <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-map"><a href="#val-map" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>map : (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span>) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-run"><a href="#val-run" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a> <span class="keyword">&#8209;&gt;</span> <a href="../index.html#type-t">t</a><span class="keyword"> * </span><span class="type-var">'a</span></code></div><div class="doc"></div></div><div class="spec val" id="val-fail"><a href="#val-fail" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>fail : exn <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></div><div class="doc"><p>Wrappers of Lwt's fail functions</p></div></div><div class="spec val" id="val-fail_with"><a href="#val-fail_with" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>fail_with : string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><p>Wrappers of <code class="code">Lwt.catch</code> and <code class="code">Lwt.try_bind</code> inside this monad</p><div class="spec val" id="val-catch"><a href="#val-catch" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>catch : (unit <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a>) <span class="keyword">&#8209;&gt;</span> (exn <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a>) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-try_bind"><a href="#val-try_bind" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>try_bind : (unit <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-m">m</a>) <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a>) <span class="keyword">&#8209;&gt;</span> (exn <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a>) <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Infix"><a href="#module-Infix" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Infix/index.html">Infix</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>The Infix module defines operators for common bind operations</p></div></div><div class="spec module" id="module-List"><a href="#module-List" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="List/index.html">List</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"><p>The List module mainly wrap the Lwt_list one in the Agent monad. Functions
suffixed with
_s chains the actions sequentially, passing around the updated agent to the
next one. The _m ones do everything in parallel, sending a copy of the
initial state to every threads and returning this same unupdated state.
The latter can be useful to retrive a bunch of ressources in batch where
the updated state is not of interest (e.g images)</p></div></div><p>get the current state of the agent, or set a new one</p><div class="spec val" id="val-get"><a href="#val-get" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get : <a href="../index.html#type-t">t</a> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-set"><a href="#val-set" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><p>Wrap the type of functions operating on the agent such as <span class="xref-unresolved" title="unresolved reference to &quot;      Agent.cookie_jar&quot;">      Agent.cookie_jar</span> or <span class="xref-unresolved" title="unresolved reference to &quot;      Agent.set_cookie_jar&quot;">      Agent.set_cookie_jar</span> to usable inside the monad.
For example, the first one go from <code class="code">Agent.t -&gt; Cookiejar.t</code> to
<code class="code">Agent.t -&gt; (Agent.t * Cookiejar.t) Lwt.t</code> by just returning the agent
unmodified together with the current cookie jar and wrap the result in
<code class="code">Lwt.return</code></p><p>Note that the redefined functions have the same name as their counterpart,
and thus will shadow or can be shadowed by them.</p><div class="spec val" id="val-save_content"><a href="#val-save_content" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>save_content : string <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-cookie_jar"><a href="#val-cookie_jar" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>cookie_jar : <a href="../../Cookiejar/index.html#type-t">Cookiejar.t</a> <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-set_cookie_jar"><a href="#val-set_cookie_jar" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_cookie_jar : <a href="../../Cookiejar/index.html#type-t">Cookiejar.t</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-add_cookie"><a href="#val-add_cookie" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_cookie : <a href="../../Cookiejar/Cookie/index.html#type-t">Cookiejar.Cookie.t</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-remove_cookie"><a href="#val-remove_cookie" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>remove_cookie : <a href="../../Cookiejar/Cookie/index.html#type-t">Cookiejar.Cookie.t</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-client_headers"><a href="#val-client_headers" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>client_headers : Cohttp.Header.t <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-set_client_headers"><a href="#val-set_client_headers" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_client_headers : Cohttp.Header.t <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-add_client_header"><a href="#val-add_client_header" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_client_header : string <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-remove_client_header"><a href="#val-remove_client_header" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>remove_client_header : string <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div><div class="spec val" id="val-set_max_redirect"><a href="#val-set_max_redirect" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>set_max_redirect : int <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-m">m</a></code></div><div class="doc"></div></div></body></html>